{"version":3,"sources":["js/scripts.js"],"names":["require","myBuffer","window","AudioContext","webkitAudioContext","context","playButton","document","querySelector","BufferLoader","urlList","callback","onload","bufferList","Array","loadCount","prototype","loadBuffer","url","index","request","XMLHttpRequest","open","responseType","loader","decodeAudioData","response","buffer","alert","length","error","console","onerror","send","load","i","init","bufferLoader","finishedLoading","removeAttribute","addEventListener","setAttribute","innerHTML","playDrumLoop","kick","snare","hihat","startTime","currentTime","tempo","eighthNoteTime","bar","time","playSound","source","createBufferSource","connect","destination","start","noteOn"],"mappings":"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","file":"scripts.cd665a19.map","sourceRoot":"..","sourcesContent":["require('../samples/kick.wav');\nrequire('../samples/snare.wav');\nrequire('../samples/hihat.wav');\n\nvar myBuffer = null;\n// Fix up prefixing\nwindow.AudioContext = window.AudioContext || window.webkitAudioContext;\nvar context = new AudioContext();\n\nconst playButton = document.querySelector(\"button\");\n\nfunction BufferLoader(context, urlList, callback) {\n  this.context = context;\n  this.urlList = urlList;\n  this.onload = callback;\n  this.bufferList = new Array();\n  this.loadCount = 0;\n}\n\nBufferLoader.prototype.loadBuffer = function(url, index) {\n  // Load buffer asynchronously\n  var request = new XMLHttpRequest();\n  request.open(\"GET\", url, true);\n  request.responseType = \"arraybuffer\";\n\n  var loader = this;\n\n  request.onload = function() {\n    // Asynchronously decode the audio file data in request.response\n    loader.context.decodeAudioData(\n      request.response,\n      function(buffer) {\n        if (!buffer) {\n          alert('error decoding file data: ' + url);\n          return;\n        }\n        loader.bufferList[index] = buffer;\n        if (++loader.loadCount == loader.urlList.length)\n          loader.onload(loader.bufferList);\n      },\n      function(error) {\n        console.error('decodeAudioData error', error);\n      }\n    );\n  }\n\n  request.onerror = function() {\n    alert('BufferLoader: XHR error');\n  }\n\n  request.send();\n}\n\nBufferLoader.prototype.load = function() {\n  for (var i = 0; i < this.urlList.length; ++i)\n  this.loadBuffer(this.urlList[i], i);\n}\n\n\n\nfunction init() {\n  // Fix up prefixing\n  window.AudioContext = window.AudioContext || window.webkitAudioContext;\n  context = new AudioContext();\n\n  bufferLoader = new BufferLoader(\n    context,\n    [\n      '/kick.a2ba9073.wav',\n      '/snare.7c5d27d5.wav',\n      '/hihat.774addd9.wav'\n    ],\n    finishedLoading\n    );\n\n  bufferLoader.load();\n}\n\nfunction finishedLoading(bufferList){\n  playButton.removeAttribute('disabled');\n\n  playButton.addEventListener(\n    \"click\",\n    function() {\n      playButton.setAttribute('disabled', 'disabled');\n      playButton.innerHTML = \"Playing\";\n      playDrumLoop(bufferList);\n    },\n    false\n  );\n}\n\nfunction playDrumLoop(bufferList){\n  const kick = bufferList[0];\n  const snare = bufferList[1];\n  const hihat = bufferList[2];\n\n  var startTime = context.currentTime + 0.100;\n  var tempo = 120; // BPM (beats per minute)\n  var eighthNoteTime = (60 / tempo) / 2;\n\n  for (var bar = 0; bar < 32; bar++) {\n    var time = startTime + bar * 8 * eighthNoteTime;\n    // Play the bass (kick) drum on beats 1, 5\n    playSound(kick, time);\n    playSound(kick, time + 4 * eighthNoteTime);\n  \n    // Play the snare drum on beats 3, 7\n    playSound(snare, time + 2 * eighthNoteTime);\n    playSound(snare, time + 6 * eighthNoteTime);\n  \n    // Play the hi-hat every eighth note.\n    for (var i = 0; i < 8; ++i) {\n      playSound(hihat, time + i * eighthNoteTime);\n    }\n  }\n}\n\nfunction playSound(buffer, time) {\n  var source = context.createBufferSource();\n  source.buffer = buffer;\n  source.connect(context.destination);\n  if (!source.start)\n    source.start = source.noteOn;\n  source.start(time);\n}\n\ninit();"]}